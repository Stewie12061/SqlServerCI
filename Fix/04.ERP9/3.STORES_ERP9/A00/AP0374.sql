IF EXISTS (SELECT TOP 1 1 FROM DBO.SYSOBJECTS WHERE ID = OBJECT_ID(N'[DBO].[AP0374]') AND  OBJECTPROPERTY(ID, N'IsProcedure') = 1)			
DROP PROCEDURE [DBO].[AP0374]
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO



-- <Summary>
---- In báo cáo theo dõi công trình cho khách hàng Bê tông Long An (CustomizeIndex = 80) tại ERP 9.1\T
-- <Param>
---- 
-- <Return>
---- 
-- <Reference>
---- 
-- <History>
---- Create by Tiểu Mai on 22/08/2017
---- Modified by ... on ...
-- <Example>
---- 

CREATE PROCEDURE [dbo].[AP0374]
				 	@DivisionID NVARCHAR(50) ,
					@FromDate DATETIME,
					@ToDate DATETIME,
					@FromObjectID NVARCHAR(50),
					@ToObjectID NVARCHAR(50),
					@FromAna03ID NVARCHAR(50),
					@ToAna03ID NVARCHAR(50) 
 AS
DECLARE @DotNay NVARCHAR(50)

		
SELECT O02.DivisionID, O02.InventoryID, O02.UnitID, O02.Ana03ID, O02.Ana06ID,
		O99.S01ID, O99.S02ID, O99.S03ID, O99.S04ID, O99.S05ID, O99.S06ID, O99.S07ID, O99.S08ID, O99.S09ID, O99.S10ID,
		O99.S11ID, O99.S12ID, O99.S13ID, O99.S14ID, O99.S15ID, O99.S16ID, O99.S17ID, O99.S18ID, O99.S19ID, O99.S20ID,
		SUM(O02.OrderQuantity) AS OrderQuantity 
INTO #DH_TEMP
FROM OT2002 O02 WITH (NOLOCK)
LEFT JOIN OT2001 O01 WITH (NOLOCK) ON O01.DivisionID = O02.DivisionID AND O01.SOrderID = O02.SOrderID
LEFT JOIN OT8899 O99 WITH (NOLOCK) ON O99.DivisionID = O02.DivisionID AND O99.TransactionID = O02.TransactionID AND O02.SOrderID = O99.VoucherID
WHERE O01.DivisionID= @DivisionID AND convert(DATETIME,O01.OrderDate,101) BETWEEN convert(DATETIME,@FromDate,101) AND convert(DATETIME,@ToDate,101)
		AND O01.OrderType = 0
		AND O01.ObjectID BETWEEN @FromObjectID AND @ToObjectID
		AND O02.Ana03ID BETWEEN @FromAna03ID AND @ToAna03ID
GROUP BY O02.DivisionID, O02.InventoryID, O02.UnitID, O02.Ana03ID, O02.Ana06ID,
		O99.S01ID, O99.S02ID, O99.S03ID, O99.S04ID, O99.S05ID, O99.S06ID, O99.S07ID, O99.S08ID, O99.S09ID, O99.S10ID,
		O99.S11ID, O99.S12ID, O99.S13ID, O99.S14ID, O99.S15ID, O99.S16ID, O99.S17ID, O99.S18ID, O99.S19ID, O99.S20ID

SELECT @DotNay = MAX(Ana06ID) FROM #DH_TEMP



SELECT DH.*, A11.AnaName AS AnaName03, ISNULL(A.OrderQuantity_DN,0) AS OrderQuantity_DN, ISNULL(B.OrderQuantity_DT,0) AS OrderQuantity_DT, ISNULL(C.ActualQuantity_DT,0) AS ActualQuantity_DT, ISNULL(C.ReturnQuantity_DT,0) AS ReturnQuantity_DT, 
	ISNULL(C.IncidentQuantity_DT,0) AS IncidentQuantity_DT, ISNULL(D.ActualQuantity_DN,0) AS ActualQuantity_DN, ISNULL(D.ReturnQuantity_DN,0) AS ReturnQuantity_DN, ISNULL(D.IncidentQuantity_DN,0) AS IncidentQuantity_DN,
	ISNULL(E.Quantity_DT,0) AS Quantity_DT, ISNULL(F.Quantity_DN,0) AS Quantity_DN, D.[Description]
FROM #DH_TEMP DH
LEFT JOIN 
(
SELECT  DivisionID, InventoryID, UnitID, Ana03ID,
		S01ID, S02ID, S03ID, S04ID, S05ID, S06ID, S07ID, S08ID, S09ID, S10ID,
		S11ID, S12ID, S13ID, S14ID, S15ID, S16ID, S17ID, S18ID, S19ID, S20ID,
		SUM(ISNULL(OrderQuantity,0)) AS OrderQuantity_DN
FROM #DH_TEMP
WHERE ISNULL(Ana06ID,'') LIKE @DotNay
GROUP BY DivisionID, InventoryID, UnitID, Ana03ID,
		S01ID, S02ID, S03ID, S04ID, S05ID, S06ID, S07ID, S08ID, S09ID, S10ID,
		S11ID, S12ID, S13ID, S14ID, S15ID, S16ID, S17ID, S18ID, S19ID, S20ID

) A ON A.DivisionID = DH.DivisionID AND A.InventoryID = DH.InventoryID AND A.UnitID = DH.UnitID AND 
			ISNULL(A.S01ID,'') = ISNULL(DH.S01ID,'') AND ISNULL(A.S02ID,'') = ISNULL(DH.S02ID,'') AND ISNULL(A.S03ID,'') = ISNULL(DH.S03ID,'') AND ISNULL(A.S04ID,'') = ISNULL(DH.S04ID,'') AND ISNULL(A.S05ID,'') = ISNULL(DH.S05ID,'') AND 
			ISNULL(A.S06ID,'') = ISNULL(DH.S06ID,'') AND ISNULL(A.S07ID,'') = ISNULL(DH.S07ID,'') AND ISNULL(A.S08ID,'') = ISNULL(DH.S08ID,'') AND ISNULL(A.S09ID,'') = ISNULL(DH.S09ID,'') AND ISNULL(A.S10ID,'') = ISNULL(DH.S10ID,'') AND
			ISNULL(A.S11ID,'') = ISNULL(DH.S11ID,'') AND ISNULL(A.S12ID,'') = ISNULL(DH.S12ID,'') AND ISNULL(A.S13ID,'') = ISNULL(DH.S13ID,'') AND ISNULL(A.S14ID,'') = ISNULL(DH.S14ID,'') AND ISNULL(A.S15ID,'') = ISNULL(DH.S15ID,'') AND
			ISNULL(A.S16ID,'') = ISNULL(DH.S16ID,'') AND ISNULL(A.S17ID,'') = ISNULL(DH.S17ID,'') AND ISNULL(A.S18ID,'') = ISNULL(DH.S18ID,'') AND ISNULL(A.S19ID,'') = ISNULL(DH.S19ID,'') AND ISNULL(A.S20ID,'') = ISNULL(DH.S20ID,'')
LEFT JOIN AT1011 A11 WITH (NOLOCK) ON A11.AnaID = DH.Ana03ID AND A11.AnaTypeID = 'A03' 
LEFT JOIN (
SELECT  DivisionID, InventoryID, UnitID, Ana03ID,
		S01ID, S02ID, S03ID, S04ID, S05ID, S06ID, S07ID, S08ID, S09ID, S10ID,
		S11ID, S12ID, S13ID, S14ID, S15ID, S16ID, S17ID, S18ID, S19ID, S20ID,
		SUM(ISNULL(OrderQuantity,0)) AS OrderQuantity_DT
FROM #DH_TEMP
WHERE ISNULL(Ana06ID,'') <> @DotNay
GROUP BY DivisionID, InventoryID, UnitID, Ana03ID,
		S01ID, S02ID, S03ID, S04ID, S05ID, S06ID, S07ID, S08ID, S09ID, S10ID,
		S11ID, S12ID, S13ID, S14ID, S15ID, S16ID, S17ID, S18ID, S19ID, S20ID

) B ON DH.DivisionID = B.DivisionID AND DH.InventoryID = B.InventoryID AND DH.UnitID = B.UnitID AND 
			ISNULL(DH.S01ID,'') = ISNULL(B.S01ID,'') AND ISNULL(DH.S02ID,'') = ISNULL(B.S02ID,'') AND ISNULL(DH.S03ID,'') = ISNULL(B.S03ID,'') AND ISNULL(DH.S04ID,'') = ISNULL(B.S04ID,'') AND ISNULL(DH.S05ID,'') = ISNULL(B.S05ID,'') AND 
			ISNULL(DH.S06ID,'') = ISNULL(B.S06ID,'') AND ISNULL(DH.S07ID,'') = ISNULL(B.S07ID,'') AND ISNULL(DH.S08ID,'') = ISNULL(B.S08ID,'') AND ISNULL(DH.S09ID,'') = ISNULL(B.S09ID,'') AND ISNULL(DH.S10ID,'') = ISNULL(B.S10ID,'') AND
			ISNULL(DH.S11ID,'') = ISNULL(B.S11ID,'') AND ISNULL(DH.S12ID,'') = ISNULL(B.S12ID,'') AND ISNULL(DH.S13ID,'') = ISNULL(B.S13ID,'') AND ISNULL(DH.S14ID,'') = ISNULL(B.S14ID,'') AND ISNULL(DH.S15ID,'') = ISNULL(B.S15ID,'') AND
			ISNULL(DH.S16ID,'') = ISNULL(B.S16ID,'') AND ISNULL(DH.S17ID,'') = ISNULL(B.S17ID,'') AND ISNULL(DH.S18ID,'') = ISNULL(B.S18ID,'') AND ISNULL(DH.S19ID,'') = ISNULL(B.S19ID,'') AND ISNULL(DH.S20ID,'') = ISNULL(B.S20ID,'')
LEFT JOIN (
SELECT A07.DivisionID, A07.InventoryID, A07.UnitID, A07.Ana03ID, 
		O99.S01ID, O99.S02ID, O99.S03ID, O99.S04ID, O99.S05ID, O99.S06ID, O99.S07ID, O99.S08ID, O99.S09ID, O99.S10ID,
		O99.S11ID, O99.S12ID, O99.S13ID, O99.S14ID, O99.S15ID, O99.S16ID, O99.S17ID, O99.S18ID, O99.S19ID, O99.S20ID,
		SUM(CASE WHEN ISNULL(A06.IsDelivery,0) <> 0 THEN ISNULL(A07.ActualQuantity,0) ELSE 0 END) AS ActualQuantity_DT,
		SUM(CASE WHEN ISNULL(A06.IsReturn,0) = 1 THEN ISNULL(A07.ActualQuantity,0) ELSE 0  END) AS ReturnQuantity_DT,
		SUM(CASE WHEN ISNULL(A06.IsReturn,0) = 2 THEN ISNULL(A07.ActualQuantity,0) ELSE 0 END) AS IncidentQuantity_DT
FROM AT2007 A07 WITH (NOLOCK)
LEFT JOIN AT2006 A06 WITH (NOLOCK) ON A06.DivisionID = A07.DivisionID AND A06.VoucherID = A07.VoucherID
LEFT JOIN WT8899 O99 WITH (NOLOCK) ON O99.DivisionID = A07.DivisionID AND O99.VoucherID = A07.VoucherID AND O99.TransactionID = A07.TransactionID
WHERE A06.DivisionID = @DivisionID AND A06.VoucherDate BETWEEN @FromDate AND @ToDate
	AND A06.KindVoucherID = 3 AND ISNULL(A07.Ana06ID,'') <> @DotNay
	AND A06.ObjectID BETWEEN @FromObjectID AND @ToObjectID
	AND A07.Ana03ID BETWEEN @FromAna03ID AND @ToAna03ID
GROUP BY A07.DivisionID, A07.InventoryID, A07.UnitID, A07.Ana03ID,
		O99.S01ID, O99.S02ID, O99.S03ID, O99.S04ID, O99.S05ID, O99.S06ID, O99.S07ID, O99.S08ID, O99.S09ID, O99.S10ID,
		O99.S11ID, O99.S12ID, O99.S13ID, O99.S14ID, O99.S15ID, O99.S16ID, O99.S17ID, O99.S18ID, O99.S19ID, O99.S20ID,
		A06.IsDelivery, A06.IsReturn
) C ON 	DH.DivisionID = C.DivisionID AND DH.InventoryID = C.InventoryID AND DH.UnitID = C.UnitID AND 
			ISNULL(DH.S01ID,'') = ISNULL(C.S01ID,'') AND ISNULL(DH.S02ID,'') = ISNULL(C.S02ID,'') AND ISNULL(DH.S03ID,'') = ISNULL(C.S03ID,'') AND ISNULL(DH.S04ID,'') = ISNULL(C.S04ID,'') AND ISNULL(DH.S05ID,'') = ISNULL(C.S05ID,'') AND 
			ISNULL(DH.S06ID,'') = ISNULL(C.S06ID,'') AND ISNULL(DH.S07ID,'') = ISNULL(C.S07ID,'') AND ISNULL(DH.S08ID,'') = ISNULL(C.S08ID,'') AND ISNULL(DH.S09ID,'') = ISNULL(C.S09ID,'') AND ISNULL(DH.S10ID,'') = ISNULL(C.S10ID,'') AND
			ISNULL(DH.S11ID,'') = ISNULL(C.S11ID,'') AND ISNULL(DH.S12ID,'') = ISNULL(C.S12ID,'') AND ISNULL(DH.S13ID,'') = ISNULL(C.S13ID,'') AND ISNULL(DH.S14ID,'') = ISNULL(C.S14ID,'') AND ISNULL(DH.S15ID,'') = ISNULL(C.S15ID,'') AND
			ISNULL(DH.S16ID,'') = ISNULL(C.S16ID,'') AND ISNULL(DH.S17ID,'') = ISNULL(C.S17ID,'') AND ISNULL(DH.S18ID,'') = ISNULL(C.S18ID,'') AND ISNULL(DH.S19ID,'') = ISNULL(C.S19ID,'') AND ISNULL(DH.S20ID,'') = ISNULL(C.S20ID,'')
LEFT JOIN (			
SELECT A07.DivisionID, A07.InventoryID, A07.UnitID, A07.Ana03ID, 
		O99.S01ID, O99.S02ID, O99.S03ID, O99.S04ID, O99.S05ID, O99.S06ID, O99.S07ID, O99.S08ID, O99.S09ID, O99.S10ID,
		O99.S11ID, O99.S12ID, O99.S13ID, O99.S14ID, O99.S15ID, O99.S16ID, O99.S17ID, O99.S18ID, O99.S19ID, O99.S20ID,
		MAX(A06.[Description]) AS [Description],
		SUM(CASE WHEN ISNULL(A06.IsDelivery,0) <> 0 THEN ISNULL(A07.ActualQuantity,0) ELSE 0 END) AS ActualQuantity_DN,
		SUM(CASE WHEN ISNULL(A06.IsReturn,0) = 1 THEN ISNULL(A07.ActualQuantity,0) ELSE 0  END) AS ReturnQuantity_DN,
		SUM(CASE WHEN ISNULL(A06.IsReturn,0) = 2 THEN ISNULL(A07.ActualQuantity,0) ELSE 0 END) AS IncidentQuantity_DN
FROM AT2007 A07 WITH (NOLOCK)
LEFT JOIN AT2006 A06 WITH (NOLOCK) ON A06.DivisionID = A07.DivisionID AND A06.VoucherID = A07.VoucherID
LEFT JOIN WT8899 O99 WITH (NOLOCK) ON O99.DivisionID = A07.DivisionID AND O99.VoucherID = A07.VoucherID AND O99.TransactionID = A07.TransactionID
WHERE A06.DivisionID = @DivisionID AND A06.VoucherDate BETWEEN @FromDate AND @ToDate
	AND A06.KindVoucherID = 3 AND ISNULL(A07.Ana06ID,'') LIKE @DotNay
	AND A06.ObjectID BETWEEN @FromObjectID AND @ToObjectID
	AND A07.Ana03ID BETWEEN @FromAna03ID AND @ToAna03ID
GROUP BY A07.DivisionID, A07.InventoryID, A07.UnitID, A07.Ana03ID,
		O99.S01ID, O99.S02ID, O99.S03ID, O99.S04ID, O99.S05ID, O99.S06ID, O99.S07ID, O99.S08ID, O99.S09ID, O99.S10ID,
		O99.S11ID, O99.S12ID, O99.S13ID, O99.S14ID, O99.S15ID, O99.S16ID, O99.S17ID, O99.S18ID, O99.S19ID, O99.S20ID,
		A06.IsDelivery, A06.IsReturn
) D ON DH.DivisionID = D.DivisionID AND DH.InventoryID = D.InventoryID AND DH.UnitID = D.UnitID AND 
			ISNULL(DH.S01ID,'') = ISNULL(D.S01ID,'') AND ISNULL(DH.S02ID,'') = ISNULL(D.S02ID,'') AND ISNULL(DH.S03ID,'') = ISNULL(D.S03ID,'') AND ISNULL(DH.S04ID,'') = ISNULL(D.S04ID,'') AND ISNULL(DH.S05ID,'') = ISNULL(D.S05ID,'') AND 
			ISNULL(DH.S06ID,'') = ISNULL(D.S06ID,'') AND ISNULL(DH.S07ID,'') = ISNULL(D.S07ID,'') AND ISNULL(DH.S08ID,'') = ISNULL(D.S08ID,'') AND ISNULL(DH.S09ID,'') = ISNULL(D.S09ID,'') AND ISNULL(DH.S10ID,'') = ISNULL(D.S10ID,'') AND
			ISNULL(DH.S11ID,'') = ISNULL(D.S11ID,'') AND ISNULL(DH.S12ID,'') = ISNULL(D.S12ID,'') AND ISNULL(DH.S13ID,'') = ISNULL(D.S13ID,'') AND ISNULL(DH.S14ID,'') = ISNULL(D.S14ID,'') AND ISNULL(DH.S15ID,'') = ISNULL(D.S15ID,'') AND
			ISNULL(DH.S16ID,'') = ISNULL(D.S16ID,'') AND ISNULL(DH.S17ID,'') = ISNULL(D.S17ID,'') AND ISNULL(DH.S18ID,'') = ISNULL(D.S18ID,'') AND ISNULL(DH.S19ID,'') = ISNULL(D.S19ID,'') AND ISNULL(DH.S20ID,'') = ISNULL(D.S20ID,'')

LEFT JOIN (
SELECT A90.InventoryID, A90.UnitID, A90.Ana03ID, SUM(A90.Quantity) AS Quantity_DT,
		O99.S01ID, O99.S02ID, O99.S03ID, O99.S04ID, O99.S05ID, O99.S06ID, O99.S07ID, O99.S08ID, O99.S09ID, O99.S10ID,
		O99.S11ID, O99.S12ID, O99.S13ID, O99.S14ID, O99.S15ID, O99.S16ID, O99.S17ID, O99.S18ID, O99.S19ID, O99.S20ID
FROM AT9000 A90 WITH (NOLOCK)
LEFT JOIN AT8899 O99 WITH (NOLOCK) ON O99.DivisionID = A90.DivisionID AND O99.VoucherID = A90.VoucherID AND O99.TransactionID = A90.TransactionID
LEFT JOIN OT2002 O02 WITH (NOLOCK) ON A90.DivisionID = O02.DivisionID AND O02.SOrderID = A90.OrderID AND O02.TransactionID = A90.OTransactionID
WHERE ISNULL(A90.OrderID,'') <> '' AND A90.DivisionID = @DivisionID
	AND ISNULL(A90.Ana06ID,'') <> @DotNay
	AND A90.VoucherDate BETWEEN @FromDate AND @ToDate
	AND A90.TransactionTypeID IN ('T04')
	AND A90.ObjectID BETWEEN @FromObjectID AND @ToObjectID
	AND A90.Ana03ID BETWEEN @FromAna03ID AND @ToAna03ID
GROUP BY A90.InventoryID, A90.UnitID, A90.Ana03ID, O99.S01ID, O99.S02ID, O99.S03ID, O99.S04ID, O99.S05ID, O99.S06ID, O99.S07ID, O99.S08ID, O99.S09ID, O99.S10ID,
		O99.S11ID, O99.S12ID, O99.S13ID, O99.S14ID, O99.S15ID, O99.S16ID, O99.S17ID, O99.S18ID, O99.S19ID, O99.S20ID
) E ON DH.DivisionID = B.DivisionID AND DH.InventoryID = B.InventoryID AND DH.UnitID = B.UnitID AND 
			ISNULL(DH.S01ID,'') = ISNULL(E.S01ID,'') AND ISNULL(DH.S02ID,'') = ISNULL(E.S02ID,'') AND ISNULL(DH.S03ID,'') = ISNULL(E.S03ID,'') AND ISNULL(DH.S04ID,'') = ISNULL(E.S04ID,'') AND ISNULL(DH.S05ID,'') = ISNULL(E.S05ID,'') AND 
			ISNULL(DH.S06ID,'') = ISNULL(E.S06ID,'') AND ISNULL(DH.S07ID,'') = ISNULL(E.S07ID,'') AND ISNULL(DH.S08ID,'') = ISNULL(E.S08ID,'') AND ISNULL(DH.S09ID,'') = ISNULL(E.S09ID,'') AND ISNULL(DH.S10ID,'') = ISNULL(E.S10ID,'') AND
			ISNULL(DH.S11ID,'') = ISNULL(E.S11ID,'') AND ISNULL(DH.S12ID,'') = ISNULL(E.S12ID,'') AND ISNULL(DH.S13ID,'') = ISNULL(E.S13ID,'') AND ISNULL(DH.S14ID,'') = ISNULL(E.S14ID,'') AND ISNULL(DH.S15ID,'') = ISNULL(E.S15ID,'') AND
			ISNULL(DH.S16ID,'') = ISNULL(E.S16ID,'') AND ISNULL(DH.S17ID,'') = ISNULL(E.S17ID,'') AND ISNULL(DH.S18ID,'') = ISNULL(E.S18ID,'') AND ISNULL(DH.S19ID,'') = ISNULL(E.S19ID,'') AND ISNULL(DH.S20ID,'') = ISNULL(E.S20ID,'')
LEFT JOIN (
SELECT A90.InventoryID, A90.UnitID, A90.Ana03ID, SUM(A90.Quantity) AS Quantity_DN,
		O99.S01ID, O99.S02ID, O99.S03ID, O99.S04ID, O99.S05ID, O99.S06ID, O99.S07ID, O99.S08ID, O99.S09ID, O99.S10ID,
		O99.S11ID, O99.S12ID, O99.S13ID, O99.S14ID, O99.S15ID, O99.S16ID, O99.S17ID, O99.S18ID, O99.S19ID, O99.S20ID
FROM AT9000 A90 WITH (NOLOCK)
LEFT JOIN AT8899 O99 WITH (NOLOCK) ON O99.DivisionID = A90.DivisionID AND O99.VoucherID = A90.VoucherID AND O99.TransactionID = A90.TransactionID
LEFT JOIN OT2002 O02 WITH (NOLOCK) ON A90.DivisionID = O02.DivisionID AND O02.SOrderID = A90.OrderID AND O02.TransactionID = A90.OTransactionID
WHERE ISNULL(A90.OrderID,'') <> '' AND A90.DivisionID = @DivisionID
	AND ISNULL(A90.Ana06ID,'') = @DotNay
	AND A90.VoucherDate BETWEEN @FromDate AND @ToDate
	AND A90.TransactionTypeID IN ('T04')
	AND A90.ObjectID BETWEEN @FromObjectID AND @ToObjectID
	AND A90.Ana03ID BETWEEN @FromAna03ID AND @ToAna03ID
GROUP BY A90.InventoryID, A90.UnitID, A90.Ana03ID, O99.S01ID, O99.S02ID, O99.S03ID, O99.S04ID, O99.S05ID, O99.S06ID, O99.S07ID, O99.S08ID, O99.S09ID, O99.S10ID,
		O99.S11ID, O99.S12ID, O99.S13ID, O99.S14ID, O99.S15ID, O99.S16ID, O99.S17ID, O99.S18ID, O99.S19ID, O99.S20ID
) F ON DH.DivisionID = B.DivisionID AND DH.InventoryID = B.InventoryID AND DH.UnitID = B.UnitID AND 
			ISNULL(DH.S01ID,'') = ISNULL(F.S01ID,'') AND ISNULL(DH.S02ID,'') = ISNULL(F.S02ID,'') AND ISNULL(DH.S03ID,'') = ISNULL(F.S03ID,'') AND ISNULL(DH.S04ID,'') = ISNULL(F.S04ID,'') AND ISNULL(DH.S05ID,'') = ISNULL(F.S05ID,'') AND 
			ISNULL(DH.S06ID,'') = ISNULL(F.S06ID,'') AND ISNULL(DH.S07ID,'') = ISNULL(F.S07ID,'') AND ISNULL(DH.S08ID,'') = ISNULL(F.S08ID,'') AND ISNULL(DH.S09ID,'') = ISNULL(F.S09ID,'') AND ISNULL(DH.S10ID,'') = ISNULL(F.S10ID,'') AND
			ISNULL(DH.S11ID,'') = ISNULL(F.S11ID,'') AND ISNULL(DH.S12ID,'') = ISNULL(F.S12ID,'') AND ISNULL(DH.S13ID,'') = ISNULL(F.S13ID,'') AND ISNULL(DH.S14ID,'') = ISNULL(F.S14ID,'') AND ISNULL(DH.S15ID,'') = ISNULL(F.S15ID,'') AND
			ISNULL(DH.S16ID,'') = ISNULL(F.S16ID,'') AND ISNULL(DH.S17ID,'') = ISNULL(F.S17ID,'') AND ISNULL(DH.S18ID,'') = ISNULL(F.S18ID,'') AND ISNULL(DH.S19ID,'') = ISNULL(F.S19ID,'') AND ISNULL(DH.S20ID,'') = ISNULL(F.S20ID,'')


GO
SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO

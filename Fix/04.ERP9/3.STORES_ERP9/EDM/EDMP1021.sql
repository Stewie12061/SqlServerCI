IF EXISTS (SELECT TOP 1 1 FROM DBO.SYSOBJECTS WHERE ID = OBJECT_ID(N'[DBO].[EDMP1021]') AND OBJECTPROPERTY(ID, N'IsProcedure') = 1)
DROP PROCEDURE [DBO].[EDMP1021]
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO

-- <Summary>
---- Load thông tin chi tiết lớp EDMF1022
-- <Param>
---- 
-- <Return>
---- 
-- <Reference>
---- 
-- <History>
----Created by: Minh Hòa, Date: 12/09/2018
--- Modify by ...: Bổ sung ...
-- <Example>

/*-- <Example>
	EDMP1021 @DivisionID='VS',@UserID='ASOFTADMIN', @APK = 'E80FA704-6CBD-4168-A7D3-2580ABDA2D64', @LanguageID ='vi-VN'

	exec EDMP1021 'MK','NV04','E80FA704-6CBD-4168-A7D3-2580ABDA2D64'
----*/

CREATE PROCEDURE EDMP1021
( 
	@DivisionID VARCHAR(50),
	@UserID VARCHAR(50),
	@APK VARCHAR(50),
	@LanguageID VARCHAR(50)
)
AS 
DECLARE @sSQL NVARCHAR (MAX),
        @sWhere NVARCHAR(MAX)


SET @sSQL = '
	SELECT EDMT1020.DivisionID, EDMT1020.APK, '+ CASE WHEN ISNULL(@LanguageID,'') = 'vi-VN' THEN 'EDMT0099.Description' ELSE 'EDMT0099.DescriptionE' END +' as LevelName, EDMT1000.GradeName, EDMT1020.QuotaID, EDMT1020.ClassID, EDMT1020.ClassName, EDMT1020.Disabled , EDMT1020.IsCommon,  
	EDMT1020.CreateUserID, EDMT1020.CreateDate, EDMT1020.LastModifyUserID, EDMT1020.LastModifyDate
	FROM EDMT1020 WITH (NOLOCK)
   	LEFT JOIN EDMT0099 ON EDMT1020.LevelID = EDMT0099.ID AND EDMT0099.Disabled = 0 AND EDMT0099.CodeMaster=''Level''
	LEFT JOIN EDMT1000 ON EDMT1020.GradeID = EDMT1000.GradeID 

	WHERE EDMT1020.APK ='''+ @APK +'''
'

EXEC (@sSQL)
--PRINT(@sSQL)


GO
SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO


/****** Object:  View [dbo].[OV2411]    Script Date: 01/13/2011 13:29:01 ******/
IF EXISTS (SELECT TOP 1 1 FROM DBO.SYSOBJECTS WHERE ID = OBJECT_ID(N'[DBO].[OV2411]') AND OBJECTPROPERTY(ID, N'IsView') = 1)
DROP VIEW [DBO].[OV2411]
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO


-- View chet phuc vu lay so luong ton kho thu te theo thoi gian
--Creater: Thuy Tuyen
--Date:18/05/2010

CREATE VIEW [dbo].[OV2411]
AS

Select WQ7000.DivisionID, WQ7000.WareHouseID, WQ7000.InventoryID, WQ7000.KindVoucherID,WQ7000.Voucherdate,WQ7000.Tranmonth,WQ7000.tranyear,
isnull (Case when WQ7000.KindVoucherID = 0 then sum (isnull(WQ7000.ActualQuantity,0))  end,0 ) - 
isnull( Case when WQ7000.KindVoucherID = 2 then isnull(sum (isnull(WQ7000.ActualQuantity,0)),0)  end ,0)+
Isnull(Case when WQ7000.KindVoucherID in (1,3) then sum (isnull(SignQuantity,0))  end ,0) AS EndQuantity,
ISNULL(S01ID,'') AS S01ID, ISNULL(S02ID,'') AS S02ID, ISNULL(S03ID,'') AS S03ID, ISNULL(S04ID,'') AS S04ID, ISNULL(S05ID,'') AS S05ID, 
ISNULL(S06ID,'') AS S06ID, ISNULL(S07ID,'') AS S07ID, ISNULL(S08ID,'') AS S08ID, ISNULL(S09ID,'') AS S09ID, ISNULL(S10ID,'') AS S10ID,
ISNULL(S11ID,'') AS S11ID, ISNULL(S12ID,'') AS S12ID, ISNULL(S13ID,'') AS S13ID, ISNULL(S14ID,'') AS S14ID, ISNULL(S15ID,'') AS S15ID, 
ISNULL(S16ID,'') AS S16ID, ISNULL(S17ID,'') AS S17ID, ISNULL(S18ID,'') AS S18ID, ISNULL(S19ID,'') AS S19ID, ISNULL(S20ID,'') AS S20ID
From WQ7000 
LEFT JOIN WT8899 W89 ON WQ7000.DivisionID = W89.DivisionID AND WQ7000.TransactionID = W89.TransactionID AND WQ7000.VoucherID = W89.VoucherID
Group by WQ7000.KindVoucherID, WQ7000.WareHouseID, WQ7000.DivisionID, WQ7000.WareHouseID, WQ7000.InventoryID, WQ7000.Voucherdate,WQ7000.Tranmonth,WQ7000.Tranyear,
ISNULL(S01ID,''), ISNULL(S02ID,''), ISNULL(S03ID,''), ISNULL(S04ID,''), ISNULL(S05ID,''), 
ISNULL(S06ID,''), ISNULL(S07ID,''), ISNULL(S08ID,''), ISNULL(S09ID,''), ISNULL(S10ID,''),
ISNULL(S11ID,''), ISNULL(S12ID,''), ISNULL(S13ID,''), ISNULL(S14ID,''), ISNULL(S15ID,''), 
ISNULL(S16ID,''), ISNULL(S17ID,''), ISNULL(S18ID,''), ISNULL(S19ID,''), ISNULL(S20ID,'')

GO

